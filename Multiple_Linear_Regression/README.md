# 重回帰分析

重回帰分析は**目的変数を複数の説明変数を使った回帰式で表す**分析。

## 分析方法
- 回帰式を求める意義がありそうか検討する
  - 散布図でプロットして分布を確認する
  - 目的変数と説明変数間の単相関係数を確認する

**相関係数の解釈の例（調べても見解が異なり決まりはない）**

相関係数の絶対値 | 解釈の例
--|--
1.0-0.9 | 非常に強い相関がある
0.9-0.7 | 強い相関がある
0.7-0.5 | 相関がある
0.5-0.4 | やや弱い相関がある
0.4-0.2  | 弱い相関がある
0.2-0.0 | 相関はない

- 重回帰式を求める
  - 偏回帰係数を求める
    - カテゴリカルデータはダミー変数化
  - 重回帰式の精度
    - 重相関係数 $R$※ を求める
    - 寄与率(決定係数) $R^2$ を確認する
    - 自由度調整済み寄与率 $R^{*2}$ を確認する（0.5以上を良い精度の目安とする。寄与率との乖離が大きい場合は回帰式に問題がある）
  - 偏回帰係数の検定
    - 有意水準（0.05 or 0.01）を設定
    - $P$ 値が有意水準より小さいことを確認
- 母回帰の推定
  - 信頼率（95％ or 99％）を設定
  - 信頼区間を求める
- 予測する
  - 信頼率（95％ or 99％）を設定
  - 予測区間を求める

※ LaTeX記法（Github上では文字化けする）

## ビジネスに活かす方法
- 価格や需要、費用を理解しやすい数式のモデルで予測する
- アンケート結果から各項目の総合満足度への影響力を分析する（注意事項あり）

## 注意すること
- 標準化残差の絶対値が大きい(>3.0)データがあった場合、除外を検討する
- ダミー変数化したカテゴリカルデータのみで重回帰分析を行う場合は**数量化Ⅰ類**という
- **多重共線性（マルチコ）**
  - 説明変数間に強い相関関係がある場合、両方を使う必要はない
- 目的変数に対する説明変数の影響度を確認するために重回回帰分析を用いるのは筋が悪い場合がある
  - 変数を基準化して標準偏回帰係数を求めた結果を使用する場合、説明変数同士の関係性が無視される
  - 構造方程式モデリング（共分散構造分析）によりパス係数を求めることで影響度を確認する
- 良い重回帰式は説明変数が少なく精度が高い回帰式を求める方法がある
  - 総あたり法
  - 変数増加法
  - 変数減少法
  - 変数増減法
  - 「情報量規定」に基づく方法
- 主成分分析、因子分析によって変数を合成する手法がある

## 参考にしたサイト
```
マンガでわかる統計学「回帰分析編」 高橋信 オーム社

https://www.nikkei-r.co.jp/glossary/id=1631
https://bellcurve.jp/statistics/course/9702.html
https://www.albert2005.co.jp/knowledge/statistics_analysis/multivariate_analysis/multiple_regression
```
